import { Component, computed, input } from '@angular/core';
import { ASSETS_WITH_RISK } from '@shared/constants';

@Component({
  selector: 'app-vulnerability-graph',
  templateUrl: './vulnerability-graph.component.html',
  styleUrl: './vulnerability-graph.component.scss',
})
export class VulnerabilityGraphComponent {
  assetsWithRisks = input.required<typeof ASSETS_WITH_RISK>();

  readonly riskCounts = computed(() => {
    const risks = { Critical: 0, High: 0, Medium: 0, Low: 0 };

    for (const asset of this.assetsWithRisks()) {
      const level = asset.contextualRisk as keyof typeof risks;
      if (level in risks) {
        risks[level]++;
      }
    }

    return risks;
  });
}
